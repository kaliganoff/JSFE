(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(a){if(a.ep)return;a.ep=!0;const r=n(a);fetch(a.href,r)}})();async function b(){return await(await fetch("https://async-race-api-ocfo.onrender.com/garage")).json()}async function f(t){return await(await fetch(`https://async-race-api-ocfo.onrender.com/garage?_limit=7&_page=${t}`)).json()}async function Q(t){return await(await fetch(`https://async-race-api-ocfo.onrender.com/garage/${t}`)).json()}function U(t){fetch("https://async-race-api-ocfo.onrender.com/garage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>e.json())}function Y(t){fetch(`https://async-race-api-ocfo.onrender.com/garage/${t}`,{method:"DELETE"}).then(e=>e.json())}function Z(t,e){fetch(`https://async-race-api-ocfo.onrender.com/garage/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(n=>n.json())}async function N(t,e){return await(await fetch(`https://async-race-api-ocfo.onrender.com/engine?id=${t}&status=${e}`,{method:"PATCH"})).json()}async function q(t){return await(await fetch(`https://async-race-api-ocfo.onrender.com/engine?id=${t}&status=drive`,{method:"PATCH"})).json()}async function _(){return await(await fetch("https://async-race-api-ocfo.onrender.com/winners")).json()}async function ee(t){return await(await fetch(`https://async-race-api-ocfo.onrender.com/winners/${t}`)).json()}async function te(t){await fetch("https://async-race-api-ocfo.onrender.com/winners",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}function ne(t){fetch(`https://async-race-api-ocfo.onrender.com/winners/${t}`,{method:"DELETE"}).then(e=>e.json())}function ae(t,e){fetch(`https://async-race-api-ocfo.onrender.com/winners/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(n=>n.json())}const z=document.createElement("p");z.innerText="The server is sleeping, please, wait...";document.body.append(z);const W=document.createElement("div"),A=document.createElement("button"),I=document.createElement("button");A.innerText="TO GARAGE";I.innerText="TO WINNERS";const s=document.createElement("div"),K=document.createElement("p");K.innerText="GARAGE";const p=document.createElement("p");let h=await b();p.innerText=`Number of cars: ${h.length}`;let i=1,d=await f(i);const S=document.createElement("p");S.innerText=`Page: ${i}`;const G=document.createElement("form"),$=document.createElement("input"),k=document.createElement("input");k.type="color";const P=document.createElement("button");P.innerText="CREATE CAR";const D=document.createElement("form"),T=document.createElement("input");T.disabled=!0;const F=document.createElement("input");F.type="color";const R=document.createElement("button");R.innerText="UPDATE CAR";const v=document.createElement("button");v.innerText="Random Cars";const x=document.createElement("button");x.innerText="Start Race";const w=document.createElement("button");w.innerText="Reset Race";w.disabled=!0;s.append(K);s.append(p);s.append(S);s.append(G);G.append($,k,P);s.append(D);D.append(T,F,R);s.append(v,x,w);const m=document.createElement("div"),V=document.createElement("p");V.innerText="WINNERS";const J=document.createElement("p"),X=document.createElement("p"),oe=await _();J.innerText=`${oe.length}`;const H=document.createElement("div");m.append(V);m.append(J);m.append(X);m.append(H);m.hidden=!0;document.body.innerHTML="";document.body.append(W);W.append(A);W.append(I);document.body.append(s);document.body.append(m);let B;const l=document.createElement("div"),g=document.createElement("div");function E(){d.forEach(t=>{const e=document.createElement("div"),n=document.createElement("p");n.innerText=t.name;const o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.id=`id${t.id}`;const a=document.createElementNS("http://www.w3.org/2000/svg","use");a.setAttribute("href","transport.svg#car"),o.style.fill=t.color,o.append(a),o.style.width="150",e.append(n),e.append(o);const r=document.createElement("button");r.innerText="SELECT",r.addEventListener("click",()=>{B=t,T.disabled=!1,T.value=B.name}),e.append(r);const c=document.createElement("button");c.innerText="REMOVE",c.addEventListener("click",async()=>{Y(t.id),ne(t.id),p.innerText=`Number of cars: ${Number(p.innerText.match(/\d+/))-1}`,l.innerHTML="",g.innerHTML="",h=await b(),d=await f(i),d.length===0&&(i-=1),E();async function L(){l.innerHTML="",S.innerText=`Page: ${i}`,d=await f(i),E()}for(let j=0;j<Math.ceil(h.length/7);j+=1){const M=document.createElement("button");M.innerText=String(j+1),M.addEventListener("click",()=>{i=Number(M.innerText),L()}),g.append(M)}}),e.append(c);const u=document.createElement("button");u.innerText="Start Engine";const y=document.createElement("button");y.innerText="Stop Engine",y.disabled=!0,e.append(u,y);let C;u.addEventListener("click",async()=>{const L=await N(t.id,"started");C=o.animate({transform:`translate(${window.innerWidth-180}px, 0%)`},{duration:Math.floor(L.distance/L.velocity),fill:"forwards"}),u.disabled=!0,y.disabled=!1,C.play();try{await q(t.id)}catch{throw C.pause(),new Error("The car has broken!")}}),y.addEventListener("click",async()=>{await N(t.id,"stopped"),y.disabled=!0,u.disabled=!1,C.cancel()}),l.append(e)})}function O(){async function t(){l.innerHTML="",S.innerText=`Page: ${i}`,d=await f(i),E()}for(let e=0;e<Math.ceil(h.length/7);e+=1){const n=document.createElement("button");n.innerText=String(e+1),n.addEventListener("click",async()=>{i=Number(n.innerText),t()}),g.append(n)}}E();O();s.append(l,g);function re(){m.hidden=!0,s.hidden=!1}async function ie(){m.hidden=!1,s.hidden=!0;const t=await _();X.innerText="Page Number: 1",J.innerText=`Number of winners: ${t.length}`,H.innerHTML="",t.forEach(async e=>{const n=document.createElement("p"),o=await Q(e.id);n.innerText=`Number: ${e.id} - Name: ${o.name} - Wins: ${e.wins} - Time: ${e.time}s`,H.append(n)})}async function ce(){const t=["Tesla","BMW","Mercedes","Ford","Opel","Toyota","Lada","Subaru","Jeep","Lamborghini"],e=["Model S","Mustang","X5","Benz","Cresta","Sedan","Supra","Gallardo","Continental","Infinity"],n=[];for(let o=0;o<100;o+=1)n.push(U({name:`${t[Math.floor(Math.random()*9)]} ${e[Math.floor(Math.random()*9)]}`,color:`#${Math.floor(Math.random()*16777215).toString(16)}`}));await Promise.all(n),p.innerText=`Number of cars: ${Number(p.innerText.match(/\d+/))+100}`,l.innerHTML="",g.innerHTML="",h=await b(),d=await f(i),E(),O()}function se(){x.disabled=!0,v.disabled=!0,P.disabled=!0,R.disabled=!0;let t=!1;d.forEach(async e=>{const n=await N(e.id,"started"),o=document.querySelector(`#id${e.id}`);let a;if(o){a=o.animate({transform:`translate(${window.innerWidth-180}px, 0%)`},{duration:n.distance/n.velocity,fill:"forwards"}),a.id=String(e.id),a.play();try{if((await q(e.id)).success&&!t){w.disabled=!1;const c=document.createElement("p");c.innerText=`${e.name} won: ${Math.floor(n.distance/n.velocity)/1e3}s`,c.className="win-notification",s.append(c),t=!0,te({id:e.id,wins:1,time:Math.floor(n.distance/n.velocity)/1e3}).catch(()=>ee(e.id).then(u=>ae(e.id,{wins:u.wins+1,time:Math.floor(n.distance/n.velocity)/1e3<u.time?Math.floor(n.distance/n.velocity)/1e3:u.time})))}}catch{throw a?.pause(),new Error("The car has broken!")}}})}function de(){x.disabled=!1,w.disabled=!0,v.disabled=!1,P.disabled=!1,R.disabled=!1,document.getAnimations().forEach(e=>e.cancel()),document.querySelector(".win-notification")?.remove(),d.forEach(async e=>{N(e.id,"stopped")})}A.addEventListener("click",re);I.addEventListener("click",ie);G.addEventListener("submit",async t=>{t.preventDefault(),p.innerText=`Number of cars: ${Number(p.innerText.match(/\d+/))+1}`,U({name:$.value,color:k.value}),l.innerHTML="",g.innerHTML="",h=await b(),d=await f(i),E(),O(),$.value=""});D.addEventListener("submit",async t=>{t.preventDefault(),Z(B.id,{name:T.value,color:F.value}),l.innerHTML="",g.innerHTML="",h=await b(),d=await f(i),E(),O(),$.value=""});v.addEventListener("click",ce);x.addEventListener("click",se);w.addEventListener("click",de);
